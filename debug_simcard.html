<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Debug Simcard</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 40px;
            max-width: 800px;
            margin: 0 auto;
        }
        .debug-panel {
            background: #f5f5f5;
            border: 2px solid #ccc;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        button {
            padding: 15px 30px;
            font-size: 18px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px 5px;
        }
        button:hover {
            background: #0056b3;
        }
        pre {
            background: #222;
            color: #0f0;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 12px;
        }
        .error { color: red; font-weight: bold; }
        .success { color: green; font-weight: bold; }
    </style>
</head>
<body>
    <h1>üîç Debug Simcard Modal</h1>

    <div class="debug-panel">
        <h2>Step 1: Check if functions exist</h2>
        <button onclick="checkFunctions()">Check Functions</button>
        <div id="check-result"></div>
    </div>

    <div class="debug-panel">
        <h2>Step 2: Try to open modal</h2>
        <button onclick="tryOpenModal()">Open Simcard Modal</button>
        <div id="modal-result"></div>
    </div>

    <div class="debug-panel">
        <h2>Step 3: Console Logs</h2>
        <pre id="console-logs">Waiting for logs...</pre>
    </div>

    <script>
        // Capture console logs
        const logs = [];
        const originalLog = console.log;
        const originalError = console.error;
        const originalWarn = console.warn;

        console.log = function(...args) {
            logs.push('[LOG] ' + args.join(' '));
            updateLogs();
            originalLog.apply(console, args);
        };

        console.error = function(...args) {
            logs.push('[ERROR] ' + args.join(' '));
            updateLogs();
            originalError.apply(console, args);
        };

        console.warn = function(...args) {
            logs.push('[WARN] ' + args.join(' '));
            updateLogs();
            originalWarn.apply(console, args);
        };

        function updateLogs() {
            document.getElementById('console-logs').textContent = logs.join('\n') || 'No logs yet...';
        }

        function checkFunctions() {
            const result = document.getElementById('check-result');
            let html = '<h3>Function Check Results:</h3><ul>';

            // Check openSimcardModal
            if (typeof openSimcardModal === 'function') {
                html += '<li class="success">‚úÖ openSimcardModal: EXISTS</li>';
            } else {
                html += '<li class="error">‚ùå openSimcardModal: NOT FOUND (type: ' + typeof openSimcardModal + ')</li>';
            }

            // Check closeSimcardModal
            if (typeof closeSimcardModal === 'function') {
                html += '<li class="success">‚úÖ closeSimcardModal: EXISTS</li>';
            } else {
                html += '<li class="error">‚ùå closeSimcardModal: NOT FOUND</li>';
            }

            // Check saveSimcard
            if (typeof saveSimcard === 'function') {
                html += '<li class="success">‚úÖ saveSimcard: EXISTS</li>';
            } else {
                html += '<li class="error">‚ùå saveSimcard: NOT FOUND</li>';
            }

            // Check currentSimcardEditId
            if (typeof currentSimcardEditId !== 'undefined') {
                html += '<li class="success">‚úÖ currentSimcardEditId: EXISTS (value: ' + currentSimcardEditId + ')</li>';
            } else {
                html += '<li class="error">‚ùå currentSimcardEditId: NOT FOUND</li>';
            }

            html += '</ul>';
            result.innerHTML = html;
        }

        async function tryOpenModal() {
            const result = document.getElementById('modal-result');
            result.innerHTML = '<p>‚è≥ Trying to open modal...</p>';

            try {
                console.log('Calling openSimcardModal()...');
                await openSimcardModal();
                result.innerHTML = '<p class="success">‚úÖ Modal opened successfully!</p>';
            } catch (error) {
                result.innerHTML = `
                    <p class="error">‚ùå Error opening modal:</p>
                    <pre>${error.message}\n\nStack:\n${error.stack}</pre>
                `;
                console.error('Error:', error);
            }
        }

        // Auto check on load
        window.addEventListener('load', () => {
            console.log('Page loaded, waiting 1 second...');
            setTimeout(() => {
                console.log('Running auto-check...');
                checkFunctions();
            }, 1000);
        });

        // Catch unhandled errors
        window.addEventListener('error', (event) => {
            console.error('Global error:', event.message, 'at', event.filename, ':', event.lineno);
        });
    </script>

    <!-- Load script.js -->
    <script src="script.js?v=1764142470"></script>
</body>
</html>
