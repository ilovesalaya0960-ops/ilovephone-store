# 📖 คู่มือการย้ายอะไหล่ระหว่างร้าน

## ⚠️ สิ่งที่ต้องรู้ก่อนใช้งาน

การ "**ตัดอะไหล่**" มี 2 ประเภท:

### 1. ✅ ย้ายไปร้านอื่น (แนะนำ)
- ลดจำนวนที่ร้านต้นทาง
- **สร้างรายการใหม่ที่ร้านปลายทาง**
- อะไหล่จะแสดงที่ร้านปลายทางทันที

### 2. ❌ ตัดไปใช้ร้านตัวเอง
- ลดจำนวนสต็อก
- แสดงในรายการ "ตัด"
- **ไม่มีการย้ายไปร้านอื่น**
- ใช้สำหรับบันทึกอะไหล่ที่ใช้ไปแล้ว (เช่น ซ่อมเครื่อง, ทดสอบ)

---

## 🎯 วิธีการย้ายอะไหล่ที่ถูกต้อง

### ขั้นตอนที่ 1: เปิด Modal
1. ไปที่เมนู **"อะไหล่"**
2. เลือกร้านต้นทาง (เช่น ร้านคลองโยง)
3. คลิกปุ่ม **"ตัดสต็อก"** ที่อะไหล่ที่ต้องการย้าย

### ขั้นตอนที่ 2: เลือกประเภท (สำคัญมาก!)
📋 จะมี dropdown **"ประเภทการตัด"** ให้เลือก:

```
┌─────────────────────────────────────────┐
│ ประเภทการตัด *                         │
│ ┌─────────────────────────────────────┐ │
│ │ ✅ ย้ายไปร้านอื่น (แนะนำ)          │ │ ← เลือกอันนี้!
│ │ ❌ ตัดไปใช้ร้านตัวเอง (ไม่ย้าย)     │ │
│ └─────────────────────────────────────┘ │
└─────────────────────────────────────────┘
```

⚠️ **ข้อควรระวัง:**
- ตัวเลือกแรก (✅ ย้ายไปร้านอื่น) เป็น **default แล้ว**
- ถ้าต้องการให้อะไหล่แสดงที่ร้านอื่น ต้องเลือก **"ย้ายไปร้านอื่น"**
- ถ้าเลือก **"ตัดไปใช้ร้านตัวเอง"** อะไหล่จะ**ไม่แสดงที่ร้านอื่น**!

### ขั้นตอนที่ 3: เลือกร้านปลายทาง
เมื่อเลือก "ย้ายไปร้านอื่น" จะมี dropdown เพิ่มขึ้นมา:

```
┌─────────────────────────────────────────┐
│ ย้ายไปร้าน *                            │
│ ┌─────────────────────────────────────┐ │
│ │ ร้านไอเลิฟโฟน - ศาลายา ▼           │ │ ← เลือกร้านปลายทาง
│ └─────────────────────────────────────┘ │
└─────────────────────────────────────────┘
```

### ขั้นตอนที่ 4: ระบุจำนวนและกดยืนยัน
1. ระบุจำนวนที่ต้องการย้าย
2. กดปุ่ม **"ยืนยันย้ายอะไหล่"**
3. ตรวจสอบข้อมูลใน popup ยืนยัน
4. กด **"ยืนยัน"**

### ขั้นตอนที่ 5: ตรวจสอบผลลัพธ์
- ระบบจะถามว่าต้องการดูที่ร้านปลายทางหรือไม่
- คลิก **"ดูที่ร้านศาลายา"** (หรือร้านที่ย้ายไป)
- อะไหล่จะแสดงที่ร้านปลายทางทันที

---

## 🔍 การตรวจสอบว่าย้ายสำเร็จ

### วิธีที่ 1: ดูที่ร้านปลายทาง
1. ไปที่เมนู "อะไหล่"
2. เลือกร้านปลายทาง (เช่น ร้านศาลายา)
3. **Hard Refresh:** กด `Cmd + Shift + R` (Mac) หรือ `Ctrl + Shift + R` (Windows)
4. คลิกแท็บ **"ทั้งหมด"** (ไม่ใช่แบรนด์เฉพาะ)
5. ควรเห็นอะไหล่ที่ย้ายมา

### วิธีที่ 2: ดู Console Logs
1. กด `F12` → แท็บ **Console**
2. ค้นหา logs ที่ขึ้นต้นด้วย `[TRANSFER]`
3. ควรเห็น:
   ```
   🚀🚀🚀 [TRANSFER v20251112d - WITH ID] Starting transfer process...
   📉 [TRANSFER] Step 1: Reducing source store quantity
   ✅ [TRANSFER] Step 1 completed: Source store updated
   🔍 [TRANSFER] Step 2: Checking existing accessories at target store
   ✅ [TRANSFER] Step 2 completed: New accessory created
   ```

---

## ❌ ปัญหาที่พบบ่อยและวิธีแก้

### ปัญหา 1: "ย้ายแล้วแต่ไม่เห็นที่ร้านปลายทาง"

**สาเหตุ:** เลือก **"ตัดไปใช้ร้านตัวเอง"** แทนที่จะเลือก **"ย้ายไปร้านอื่น"**

**วิธีแก้:**
- ไม่ต้องย้ายซ้ำอีกครั้ง
- ติดต่อผู้ดูแลระบบเพื่อแก้ไขข้อมูลใน database

### ปัญหา 2: "ไม่เห็นอะไหล่หลังจาก refresh"

**วิธีแก้:**
1. **Hard Refresh:** กด `Cmd + Shift + R` (Mac) หรือ `Ctrl + Shift + R` (Windows)
2. คลิกแท็บ **"ทั้งหมด"** (อย่า filter แบรนด์)
3. ตรวจสอบว่าเลือกร้านถูกต้อง

### ปัญหา 3: "ระบบแสดง error"

**วิธีแก้:**
1. กด `F12` → แท็บ **Console**
2. ดู error message
3. แจ้งข้อความ error ให้ผู้ดูแลระบบ

---

## 📊 ตัวอย่างการใช้งาน

### ตัวอย่างที่ 1: ย้ายแบต Samsung จากคลองโยงไปศาลายา

```
1. อยู่ที่ร้านคลองโยง → คลิก "ตัดสต็อก" ที่แบต Samsung A03
2. เลือก "✅ ย้ายไปร้านอื่น"
3. เลือกร้านปลายทาง: "ร้านศาลายา"
4. ระบุจำนวน: 1
5. กด "ยืนยันย้ายอะไหล่"
6. ตรวจสอบข้อมูล → กด "ยืนยัน"
7. คลิก "ดูที่ร้านศาลายา"
8. ✅ เห็นแบต Samsung แสดงอยู่ที่ร้านศาลายา
```

### ตัวอย่างที่ 2: ตัดอะไหล่ที่ใช้ซ่อมเครื่อง (ไม่ย้ายร้าน)

```
1. อยู่ที่ร้านคลองโยง → คลิก "ตัดสต็อก" ที่จอ iPhone 12
2. เลือก "❌ ตัดไปใช้ร้านตัวเอง (ไม่ย้าย)"
3. ระบุจำนวน: 1
4. ระบุราคา: 2,500 บาท
5. หมายเหตุ: "ใช้ซ่อมเครื่อง iPhone 12 ลูกค้า คุณสมชาย"
6. กด "ยืนยันตัดอะไหล่ (ไม่ย้ายร้าน)"
7. ⚠️ อ่านคำเตือน → กด "ยืนยัน"
8. ✅ จอถูกตัดออกจากสต็อก (แสดงในรายการ "ตัด")
```

---

## 🛠️ ไฟล์ทดสอบ

หากต้องการทดสอบระบบก่อนใช้งานจริง สามารถเปิดไฟล์ทดสอบได้ที่:

```bash
open /Users/chakkapong/Sites/ilovephone-store/test_transfer_ui.html
```

หรือเปิดในเบราว์เซอร์:
```
file:///Users/chakkapong/Sites/ilovephone-store/test_transfer_ui.html
```

---

## 📞 ติดต่อสอบถาม

หากมีปัญหาหรือข้อสงสัย กรุณาติดต่อผู้ดูแลระบบพร้อม:
- Screenshot หน้าจอ
- Console logs (F12 → Console)
- รายละเอียดอะไหล่ที่ต้องการย้าย

---

**อัพเดทล่าสุด:** 16 พฤศจิกายน 2025
**เวอร์ชัน:** 2.0 - แก้ไขให้ชัดเจนและใช้งานง่ายขึ้น
